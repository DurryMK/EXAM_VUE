{"remainingRequest":"D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\node_modules\\babel-loader\\lib\\index.js!D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\src\\components\\Core.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\src\\components\\Core.vue","mtime":1606406276709},{"path":"D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1606012761609},{"path":"D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\node_modules\\babel-loader\\lib\\index.js","mtime":1606012784177},{"path":"D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1606012761609},{"path":"D:\\durry\\HBx\\HBworkplace\\EXAM_VUE\\node_modules\\vue-loader\\lib\\index.js","mtime":1606012779294}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nfunction formatTimeText(totalTime) {\n  var h = Math.floor(totalTime / 60 / 60);\n  var m = Math.floor((totalTime - h * 60 * 60) / 60);\n  var s = totalTime - h * 60 * 60 - m * 60;\n\n  if (h < 10) {\n    h = \"0\" + h;\n  }\n\n  if (m < 10) {\n    m = \"0\" + m;\n  }\n\n  if (s < 10) {\n    s = \"0\" + s;\n  }\n\n  return h + \"小时 \" + m + \"分 \" + s + \"秒\";\n}\n\nexport default {\n  name: 'Core',\n  props: {},\n  created: function created() {},\n  mounted: function mounted() {\n    this.$axios.defaults.withCredentials = true;\n\n    if (this.isCopy) {\n      //开启禁止复制\n      this.$nextTick(function () {\n        // 禁用右键\n        document.oncontextmenu = new Function(\"event.returnValue=false\"); // 禁用选择\n\n        document.onselectstart = new Function(\"event.returnValue=false\");\n      });\n    }\n\n    if (this.isLeave) {\n      //开启页面切换监听\n      window.addEventListener(\"focus\", this.enter);\n      window.addEventListener(\"blur\", this.leave);\n    }\n  },\n  data: function data() {\n    return {\n      paperId: \"123\",\n      //本张试卷的编号\n      examineeId: \"123\",\n      //本场考生的用户id\n      runningId: this.getUUID(),\n      //本场考试的唯一标识\n      isLimit: false,\n      //是否开启考试限时功能\n      isCopy: false,\n      //是否开启禁止复制功能\n      isPaste: false,\n      //是否开启禁止粘贴功能\n      isLeave: true,\n      //是否开启监听切换页面功能\n      isCamera: true,\n      //是否开启智能视频监考\n      isBegin: false,\n      //是否开始考试\n      totalTime: 120,\n      //考试总时长\n      totalTimeText: '考试尚未开始',\n      activeIndex: '0',\n      //顶部激活的菜单\n      leaveNum: 3,\n      //允许离开考试界面的次数\n      leaveTime: 0,\n      //已经离开考试界面的次数\n      detectionTime: 120,\n      //图像采集的持续时间\n      timeId: \"\",\n      //计时器id\n      player: null //视频显示对象\n\n    };\n  },\n  methods: {\n    topa: function topa(event) {\n      console.log(event);\n    },\n    enter: function enter() {\n      console.log(\"进入页面\");\n    },\n    leave: function leave() {\n      if (this.isBegin) {\n        this.leaveTime++;\n      }\n    },\n    handleSelect: function handleSelect() {},\n    begin: function begin() {\n      //开始考试计时\n      if (!this.isBegin) {\n        if (this.isCamera) {\n          this.vedioHandle_1(); //开启视频监考流程\n        }\n\n        this.isBegin = true;\n        this.timeId = setInterval(this.timer_, 1000);\n      }\n    },\n    vedioHandle_1: function vedioHandle_1() {\n      var _this2 = this;\n\n      //视频监考流程处理\n      //1.提示开始人脸图像收集\n      this.$confirm('本场考试已开启视频监考,即将开始收集考生人脸图像信息, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'info',\n        center: true\n      }).then(function (v) {\n        _this2.vedioHandle_2();\n      }).catch(function () {\n        _this2.$message({\n          type: 'error',\n          message: '图像采集失败,请刷新页面重试'\n        });\n      });\n    },\n    vedioHandle_2: function vedioHandle_2() {\n      //开始人脸图像收集\n      this.$message({\n        type: 'success',\n        message: '请保持面部正对摄像头,图像采集将在1分钟内完成',\n        duration: 6000,\n        iconClass: 'el-icon-camera-solid'\n      }); //2.打开摄像头\n\n      this.cameraOpenHandle(); //3.两分钟内不停截取图像 直到检测到人脸并记录\n      //坑：vue中必须使用_this指向this才能实现延迟调用函数的效果\n\n      var _this = this;\n\n      setTimeout(function () {\n        _this.faceDetection();\n      }, 3000); //4.开始计时 两分钟内持续检测\n\n      this.timeId = setInterval(this.timer__, 1000);\n    },\n    faceDetection: function faceDetection() {\n      var _this3 = this;\n\n      //图像采集检测\n      //截取一张图像传到服务端检测\n      var imgStr = this.getImage();\n      imgStr = imgStr.replace(\"data:image/png;base64,\", \"\");\n      this.$axios({\n        url: this.baseUrl + \"/faceDetectionOp\",\n        method: \"POST\",\n        params: {\n          imgStr: imgStr,\n          paperId: this.paperId,\n          examineeId: this.examineeId,\n          runningId: this.runningId\n        }\n      }).then(function (res) {\n        if (res.data.E_BACKSTATUS == '0') {\n          _this3.$message({\n            type: 'success',\n            message: '图像采集已完成,请开始作答',\n            duration: 1000\n          }); //停止采集图像倒计时\n\n\n          clearInterval(_this3.timeId); //开启视频监考\n\n          _this3.vedioHandle_3();\n        } else {\n          _this3.$message({\n            type: 'success',\n            message: '请保持面部正对摄像头,图像采集将在2分钟内完成',\n            duration: 2000,\n            iconClass: 'el-icon-camera-solid'\n          });\n\n          _this3.$message({\n            type: 'error',\n            message: res.data.E_BACKINFO,\n            duration: 1000\n          }); // 检测失败重新检测\n\n\n          if (_this3.detectionTime > 0) {\n            //防止页面闪烁过快 3000调一次接口\n            var _this = _this3;\n            setTimeout(function () {\n              _this.faceDetection();\n            }, 3000);\n          }\n        }\n      });\n    },\n    vedioHandle_3: function vedioHandle_3() {\n      var _this4 = this;\n\n      //持续的视频监考\n      if (this.totalTime == 0) {\n        return;\n      } //截取一张图像传到服务端\n\n\n      var imgStr = this.getImage();\n      imgStr = imgStr.replace(\"data:image/png;base64,\", \"\");\n      this.$axios({\n        url: this.baseUrl + \"/faceCompareOp\",\n        method: \"POST\",\n        params: {\n          imgStr: imgStr,\n          paperId: this.paperId,\n          examineeId: this.examineeId,\n          runningId: this.runningId\n        }\n      }).then(function (res) {\n        if (res.data.E_BACKSTATUS == '0') {// 人脸对比成功 \n        } else {\n          // 对比失败发出警示\n          _this4.$message({\n            type: 'error',\n            message: '考试过程中,请保持面部在采集框内',\n            duration: 1000,\n            iconClass: 'el-icon-camera-solid'\n          });\n        }\n\n        if (_this4.totalTime > 0) {\n          //继续下一次检测  生成一个随机检测时间\n          var nextTime = Math.floor(Math.random() * (12 - 1 + 1) + 1);\n          console.log(\"下一次检测在\" + nextTime + \"秒后\");\n          var _this = _this4;\n          setTimeout(function () {\n            _this.vedioHandle_3();\n          }, nextTime * 1000);\n        }\n      });\n    },\n    cameraOpenHandle: function cameraOpenHandle() {\n      //开启摄像头\n      //固定套路\n      if (navigator.mediaDevices === undefined) {\n        navigator.mediaDevices = {};\n      }\n\n      if (navigator.mediaDevices.getUserMedia === undefined) {\n        navigator.mediaDevices.getUserMedia = function (constraints) {\n          var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\n          if (!getUserMedia) {\n            return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n            console.log(\"浏览器不支持\");\n          }\n\n          return new Promise(function (resolve, reject) {\n            getUserMedia.call(navigator, constraints, resolve, reject);\n          });\n        };\n      }\n\n      var constraints = {\n        video: true,\n        audio: false\n      };\n      var videoPlaying = false;\n      var v = document.getElementById('player');\n      var promise = navigator.mediaDevices.getUserMedia(constraints);\n      promise.then(function (stream) {\n        if (\"srcObject\" in v) {\n          v.srcObject = stream;\n        } else {\n          v.src = window.URL.createObjectURL(stream);\n        }\n\n        v.onloadedmetadata = function (e) {\n          v.play();\n          videoPlaying = true;\n        };\n      }).catch(function (err) {\n        console.error(err.name + \": \" + err.message);\n      });\n      this.player = v;\n    },\n    getImage: function getImage() {\n      //截取视频框的信息\n      var canvas = document.getElementById(\"canvas\");\n      canvas.getContext('2d').drawImage(this.player, 0, 0, 100, 100); // 获取图片base64链接\n\n      var image = canvas.toDataURL('image/png');\n      return image;\n    },\n    stopCa: function stopCa() {\n      //停止摄像\n      this.player.srcObject.getTracks()[0].stop();\n    },\n    timer_: function timer_() {\n      //本场考试的计时\n      this.totalTime--;\n      this.totalTimeText = formatTimeText(this.totalTime);\n\n      if (this.totalTime == 0) {\n        this.isBegin = false;\n        this.totalTimeText = \"考试已结束\";\n        this.stopCa(); //关闭摄像头\n\n        clearInterval(this.timeId);\n      }\n    },\n    timer__: function timer__() {\n      //图像采集的计时\n      this.detectionTime--;\n\n      if (this.detectionTime == 0) {\n        clearInterval(this.timeId);\n        this.$message({\n          type: 'error',\n          message: '图像采集失败,请刷新页面后重试',\n          duration: 3000,\n          iconClass: 'el-icon-camera-solid'\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["Core.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<el-container>\r\n\t\t<el-header>\r\n\t\t\t<el-backtop @click.prevent.self=\"topa\" :bottom=\"100\" :visibility-height=1 disabled>\r\n\t\t\t\t<i class=\"el-icon-view\"></i>\r\n\t\t\t</el-backtop>\r\n\t\t\t<el-menu :default-active=\"activeIndex\" class=\"el-menu-demo\" mode=\"horizontal\" @select=\"handleSelect\">\r\n\t\t\t\t<el-menu-item index=\"1\"><i class=\"el-icon-switch-button\"></i>结束考试</el-menu-item>\r\n\t\t\t\t<el-menu-item index=\"2\"><i class=\"el-icon-info\"></i>本场考试须知</el-menu-item>\r\n\t\t\t</el-menu>\r\n\t\t</el-header>\r\n\t\t<el-main>\r\n\t\t\t<el-col :span=\"4\">\r\n\t\t\t\t<!-- 监考区域开考状态 -->\r\n\t\t\t\t<el-card style=\"height: 650px;\">\r\n\t\t\t\t\t<!-- 计时栏 -->\r\n\t\t\t\t\t<el-col :span=\"24\">\r\n\t\t\t\t\t\t<el-tag style=\"width: 100%;background-color: white;\"><i class=\"el-icon-time\"></i>&nbsp;&nbsp;{{totalTimeText}}</span></el-tag>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t\t<!-- 智能监考提示语 -->\r\n\t\t\t\t\t<el-col :span=\"24\">\r\n\t\t\t\t\t\t<el-tag type=\"success\" style=\"width: 100%;\"><i class=\"el-icon-view\"></i>&nbsp;&nbsp;智能监考已开启<br />\r\n\t\t\t\t\t\t</el-tag>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t\t<!-- 页面监听 -->\r\n\t\t\t\t\t<el-col :span=\"24\" v-show=\"leaveTime!=0\">\r\n\t\t\t\t\t\t<el-tag type=\"warning\" style=\"width: 100%;\"><span><i class=\"el-icon-camera-solid\"></i>&nbsp;&nbsp;你已经离开页面{{leaveTime}}次</span>\r\n\t\t\t\t\t\t</el-tag>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t\t<!-- 视频监考区 -->\r\n\t\t\t\t\t<el-col :span=\"24\" style=\"border-radius: 30px\">\r\n\t\t\t\t\t\t<video id=\"player\" style=\"width: 100px;height: 100px;\"></video>\r\n\t\t\t\t\t\t<canvas id=\"canvas\" style=\"display:none;\"></canvas>\r\n\t\t\t\t\t\t<el-button @click=\"stopCa()\">停止</el-button>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t</el-card>\r\n\t\t\t</el-col>\r\n\t\t\t<el-col :span=\"19\" :offset=\"1\">\r\n\t\t\t\t<!-- 考试信息确认 -->\r\n\t\t\t\t<el-card v-show=\"!isBegin\" shadow=\"always\" style=\"height: 650px;\">\r\n\t\t\t\t\t<div @click.stop>\r\n\t\t\t\t\t\t<el-button @click=\"begin\">确认开始考试</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-card>\r\n\t\t\t\t<!-- 考试内容 -->\r\n\t\t\t\t<el-card v-show=\"isBegin\" shadow=\"always\" style=\"height: 650px;\">\r\n\t\t\t\t\t<span>请你仔细看：小草在努力生长，花儿在尽情绽放，蝶儿翩翩起舞，飞鸟空中翱翔，校园里学生们认真读书学习，社会中人们勤奋工作、生活……这是我们祖国的美丽画卷，万物的努力都是为祖国赢得更美好的明天！因为，我们都相信，祖国的未来不是梦！\r\n\r\n\t\t\t\t\t\t我们期待着，环保意识注入每个人的心中，环保行动投入整个社会，这是人们现在的梦想，这也会是祖国不久后的现实。“水是生命的源泉”，水滋养了一代又一代人民，净化、荡涤着人们的心灵。为了中国梦，请从现在开始珍惜每一滴水，让每一滴水都滋润中国人的心田！\r\n\r\n\t\t\t\t\t\t在草木茂盛，鸟语花香的季节里，漫步在优美的环境中，总是会令人心旷神怡，那就不要让垃圾污染了美丽的景色。看到垃圾，俯身轻轻拾起，正确地放入分类垃圾桶中。顿时，你会感到心情舒畅，所有人都在向你点头微笑。有了垃圾，不乱丢；看到垃圾，主动拾。那我们的社会将会多么美丽，祖国将会多么整洁，让全世界都仰慕这优美的文化古国——中国！\r\n\r\n\t\t\t\t\t\t我们期待着，这个社会有更多的和谐与无私，这是人们现在的梦想，这也将会是祖国不久后的现实。现在的社会很可作文https://wWw.ZuoWenwang.Net/怕，黑心商人们为了谋取个人的利益，将有毒有害的物质添加进入商品中，如今，就连食物也成了人们心中的危险品。自私吞噬了一些人的美好心灵，请大家敞开心扉，扪心自问，到底该如何来面对这个社会，那答案一定会是：真诚无私。只要抛弃了心中的自私贪婪，让无私，纯真，快乐永驻心中，不再想获得那一丝利益，不再去碰触那一点私心，真诚无私的面对这个世界。那么，快乐将重回人们的脸上，放心将重驻人们的心中，祖国也将更加和谐繁荣！请为了中国梦，真诚无私一次吧！\r\n\r\n\t\t\t\t\t\t我们青少年，也将会是祖国的未来。俗话说：“少年富则国富，少年强则国强。”青少年是国家与民族的希望，只有现在我们努力读书，勤奋刻苦，长大后才能够装点祖国，回报社会。现在，我们是祖国的花朵；将来，我们就是祖国的栋梁，同学们，有了我们的努力，祖国定会大放光彩。请为了中国梦，奋力拼搏，实现人生的价值，释放生命的光辉，因为，我们就是祖国的未来。\r\n\r\n\t\t\t\t\t\t祖国的未来不是梦，我们认真的过每一分钟，祖国的未来不是梦，我们的心跟着希望在动，跟着希望在动……\r\n\r\n\t\t\t\t\t\t哦，沸腾吧，中国梦！</span>\r\n\t\t\t\t</el-card>\r\n\t\t\t</el-col>\r\n\t\t</el-main>\r\n\t</el-container>\r\n\r\n</template>\r\n\r\n<script>\r\n\tfunction formatTimeText(totalTime) {\r\n\t\tvar h = Math.floor(totalTime / 60 / 60)\r\n\t\tvar m = Math.floor((totalTime - (h * 60 * 60)) / 60)\r\n\t\tvar s = (totalTime - (h * 60 * 60) - (m * 60))\r\n\t\tif (h < 10) {\r\n\t\t\th = \"0\" + h\r\n\t\t}\r\n\t\tif (m < 10) {\r\n\t\t\tm = \"0\" + m\r\n\t\t}\r\n\t\tif (s < 10) {\r\n\t\t\ts = \"0\" + s\r\n\t\t}\r\n\t\treturn h + \"小时 \" + m + \"分 \" + s + \"秒\"\r\n\t}\r\n\texport default {\r\n\t\tname: 'Core',\r\n\t\tprops: {},\r\n\t\tcreated() {\r\n\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.$axios.defaults.withCredentials = true\r\n\t\t\tif (this.isCopy) {\r\n\t\t\t\t//开启禁止复制\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t// 禁用右键\r\n\t\t\t\t\tdocument.oncontextmenu = new Function(\"event.returnValue=false\");\r\n\t\t\t\t\t// 禁用选择\r\n\t\t\t\t\tdocument.onselectstart = new Function(\"event.returnValue=false\");\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (this.isLeave) {\r\n\t\t\t\t//开启页面切换监听\r\n\t\t\t\twindow.addEventListener(\"focus\", this.enter);\r\n\t\t\t\twindow.addEventListener(\"blur\", this.leave);\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpaperId: \"123\", //本张试卷的编号\r\n\t\t\t\texamineeId: \"123\", //本场考生的用户id\r\n\t\t\t\trunningId: this.getUUID(), //本场考试的唯一标识\r\n\r\n\t\t\t\tisLimit: false, //是否开启考试限时功能\r\n\t\t\t\tisCopy: false, //是否开启禁止复制功能\r\n\t\t\t\tisPaste: false, //是否开启禁止粘贴功能\r\n\t\t\t\tisLeave: true, //是否开启监听切换页面功能\r\n\t\t\t\tisCamera: true, //是否开启智能视频监考\r\n\t\t\t\tisBegin: false, //是否开始考试\r\n\t\t\t\ttotalTime: 120, //考试总时长\r\n\t\t\t\ttotalTimeText: '考试尚未开始',\r\n\r\n\t\t\t\tactiveIndex: '0', //顶部激活的菜单\r\n\t\t\t\tleaveNum: 3, //允许离开考试界面的次数\r\n\t\t\t\tleaveTime: 0, //已经离开考试界面的次数\r\n\r\n\t\t\t\tdetectionTime: 120, //图像采集的持续时间\r\n\r\n\t\t\t\ttimeId: \"\", //计时器id\r\n\r\n\t\t\t\tplayer: null, //视频显示对象\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\ttopa(event) {\r\n\t\t\t\tconsole.log(event)\r\n\t\t\t},\r\n\t\t\tenter() {\r\n\t\t\t\tconsole.log(\"进入页面\")\r\n\t\t\t},\r\n\t\t\tleave() {\r\n\t\t\t\tif (this.isBegin) {\r\n\t\t\t\t\tthis.leaveTime++\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleSelect() {\r\n\r\n\t\t\t},\r\n\t\t\tbegin() { //开始考试计时\r\n\t\t\t\tif (!this.isBegin) {\r\n\t\t\t\t\tif (this.isCamera) {\r\n\t\t\t\t\t\tthis.vedioHandle_1() //开启视频监考流程\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.isBegin = true\r\n\t\t\t\t\tthis.timeId = setInterval(this.timer_, 1000)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tvedioHandle_1() { //视频监考流程处理\r\n\t\t\t\t//1.提示开始人脸图像收集\r\n\t\t\t\tthis.$confirm('本场考试已开启视频监考,即将开始收集考生人脸图像信息, 是否继续?', '提示', {\r\n\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\ttype: 'info',\r\n\t\t\t\t\tcenter: true\r\n\t\t\t\t}).then(v => {\r\n\t\t\t\t\tthis.vedioHandle_2()\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\tmessage: '图像采集失败,请刷新页面重试'\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tvedioHandle_2() { //开始人脸图像收集\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\tmessage: '请保持面部正对摄像头,图像采集将在1分钟内完成',\r\n\t\t\t\t\tduration: 6000,\r\n\t\t\t\t\ticonClass: 'el-icon-camera-solid'\r\n\t\t\t\t});\r\n\t\t\t\t//2.打开摄像头\r\n\t\t\t\tthis.cameraOpenHandle()\r\n\t\t\t\t//3.两分钟内不停截取图像 直到检测到人脸并记录\r\n\t\t\t\t//坑：vue中必须使用_this指向this才能实现延迟调用函数的效果\r\n\t\t\t\tlet _this = this\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t_this.faceDetection()\r\n\t\t\t\t}, 3000)\r\n\t\t\t\t//4.开始计时 两分钟内持续检测\r\n\t\t\t\tthis.timeId = setInterval(this.timer__, 1000)\r\n\t\t\t},\r\n\t\t\tfaceDetection() { //图像采集检测\r\n\t\t\t\t//截取一张图像传到服务端检测\r\n\t\t\t\tlet imgStr = this.getImage()\r\n\t\t\t\timgStr = imgStr.replace(\"data:image/png;base64,\", \"\")\r\n\t\t\t\tthis.$axios({\r\n\t\t\t\t\turl: this.baseUrl + \"/faceDetectionOp\",\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\tparams: {\r\n\t\t\t\t\t\timgStr: imgStr,\r\n\t\t\t\t\t\tpaperId: this.paperId,\r\n\t\t\t\t\t\texamineeId: this.examineeId,\r\n\t\t\t\t\t\trunningId: this.runningId,\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.data.E_BACKSTATUS == '0') {\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\tmessage: '图像采集已完成,请开始作答',\r\n\t\t\t\t\t\t\tduration: 1000,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//停止采集图像倒计时\r\n\t\t\t\t\t\tclearInterval(this.timeId)\r\n\t\t\t\t\t\t//开启视频监考\r\n\t\t\t\t\t\tthis.vedioHandle_3()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\tmessage: '请保持面部正对摄像头,图像采集将在2分钟内完成',\r\n\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t\ticonClass: 'el-icon-camera-solid'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\tmessage: res.data.E_BACKINFO,\r\n\t\t\t\t\t\t\tduration: 1000,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// 检测失败重新检测\r\n\t\t\t\t\t\tif (this.detectionTime > 0) {\r\n\t\t\t\t\t\t\t//防止页面闪烁过快 3000调一次接口\r\n\t\t\t\t\t\t\tlet _this = this\r\n\t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\t_this.faceDetection()\r\n\t\t\t\t\t\t\t}, 3000)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tvedioHandle_3() { //持续的视频监考\r\n\t\t\t\tif (this.totalTime == 0) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t//截取一张图像传到服务端\r\n\t\t\t\tlet imgStr = this.getImage()\r\n\t\t\t\timgStr = imgStr.replace(\"data:image/png;base64,\", \"\")\r\n\t\t\t\tthis.$axios({\r\n\t\t\t\t\turl: this.baseUrl + \"/faceCompareOp\",\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\tparams: {\r\n\t\t\t\t\t\timgStr: imgStr,\r\n\t\t\t\t\t\tpaperId: this.paperId,\r\n\t\t\t\t\t\texamineeId: this.examineeId,\r\n\t\t\t\t\t\trunningId: this.runningId,\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.data.E_BACKSTATUS == '0') {\r\n\t\t\t\t\t\t// 人脸对比成功 \r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 对比失败发出警示\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\tmessage: '考试过程中,请保持面部在采集框内',\r\n\t\t\t\t\t\t\tduration: 1000,\r\n\t\t\t\t\t\t\ticonClass: 'el-icon-camera-solid'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.totalTime > 0) {\r\n\t\t\t\t\t\t//继续下一次检测  生成一个随机检测时间\r\n\t\t\t\t\t\tlet nextTime = Math.floor(Math.random() * (12 - 1 + 1) + 1)\r\n\t\t\t\t\t\tconsole.log(\"下一次检测在\" + nextTime + \"秒后\")\r\n\t\t\t\t\t\tlet _this = this\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t_this.vedioHandle_3()\r\n\t\t\t\t\t\t}, nextTime * 1000)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcameraOpenHandle() { //开启摄像头\r\n\t\t\t\t//固定套路\r\n\t\t\t\tif (navigator.mediaDevices === undefined) {\r\n\t\t\t\t\tnavigator.mediaDevices = {};\r\n\t\t\t\t}\r\n\t\t\t\tif (navigator.mediaDevices.getUserMedia === undefined) {\r\n\t\t\t\t\tnavigator.mediaDevices.getUserMedia = function(constraints) {\r\n\t\t\t\t\t\tvar getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\r\n\t\t\t\t\t\tif (!getUserMedia) {\r\n\t\t\t\t\t\t\treturn Promise.reject(new Error('getUserMedia is not implemented in this browser'))\r\n\t\t\t\t\t\t\tconsole.log(\"浏览器不支持\")\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\t\t\t\t\tgetUserMedia.call(navigator, constraints, resolve, reject);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tconst constraints = {\r\n\t\t\t\t\tvideo: true,\r\n\t\t\t\t\taudio: false\r\n\t\t\t\t};\r\n\t\t\t\tlet videoPlaying = false;\r\n\t\t\t\tlet v = document.getElementById('player');\r\n\t\t\t\tlet promise = navigator.mediaDevices.getUserMedia(constraints);\r\n\t\t\t\tpromise.then(stream => {\r\n\t\t\t\t\tif (\"srcObject\" in v) {\r\n\t\t\t\t\t\tv.srcObject = stream;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tv.src = window.URL.createObjectURL(stream);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tv.onloadedmetadata = function(e) {\r\n\t\t\t\t\t\tv.play();\r\n\t\t\t\t\t\tvideoPlaying = true;\r\n\t\t\t\t\t};\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tconsole.error(err.name + \": \" + err.message);\r\n\t\t\t\t})\r\n\t\t\t\tthis.player = v\r\n\t\t\t},\r\n\t\t\tgetImage() { //截取视频框的信息\r\n\t\t\t\tlet canvas = document.getElementById(\"canvas\")\r\n\t\t\t\tcanvas.getContext('2d').drawImage(this.player, 0, 0, 100, 100)\r\n\t\t\t\t// 获取图片base64链接\r\n\t\t\t\tvar image = canvas.toDataURL('image/png')\r\n\t\t\t\treturn image\r\n\t\t\t},\r\n\t\t\tstopCa() { //停止摄像\r\n\t\t\t\tthis.player.srcObject.getTracks()[0].stop()\r\n\t\t\t},\r\n\t\t\ttimer_() { //本场考试的计时\r\n\t\t\t\tthis.totalTime--\r\n\t\t\t\tthis.totalTimeText = formatTimeText(this.totalTime)\r\n\t\t\t\tif (this.totalTime == 0) {\r\n\t\t\t\t\tthis.isBegin = false\r\n\t\t\t\t\tthis.totalTimeText = \"考试已结束\"\r\n\t\t\t\t\tthis.stopCa() //关闭摄像头\r\n\t\t\t\t\tclearInterval(this.timeId)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttimer__() { //图像采集的计时\r\n\t\t\t\tthis.detectionTime--\r\n\t\t\t\tif (this.detectionTime == 0) {\r\n\t\t\t\t\tclearInterval(this.timeId)\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\tmessage: '图像采集失败,请刷新页面后重试',\r\n\t\t\t\t\t\tduration: 3000,\r\n\t\t\t\t\t\ticonClass: 'el-icon-camera-solid'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\n"],"sourceRoot":"src/components"}]}